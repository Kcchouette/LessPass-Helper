<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>LessPass</title>
		<meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">	
	</head>
	
	<body>
	<h1>A LessPass helper</h1>
	<div style="display: block;" id="importDatas">
		Where LessPass pure is forked:<br>
		<input type="text" id="lesspass-emplacement" placeholder="file:///C:/[FOLDER]/lesspass-pure/">

		LessPass JSON file input:<br>
		<textarea style="width: 381px; height: 345px;" id="lesspass-input"></textarea>
		<br>
		<button type="button" onclick="javascript:importData()">Import</button>
	</div>

	<p id="lesspass-links"></p>

	<div style="display: none;" id="exportDatas">
		<button type="button" onclick="javascript:toggle_visibility('add-setting')">Add a setting</button>
			<div style="display: none;" id="add-setting">
				<input type="text" id="site">
				<input type="text" id="login">
				<input type="checkbox" id="uppercase" name="uppercase" value="true">
				<input type="checkbox" id="lowercase" name="lowercase" value="true">
				<input type="checkbox" id="numbers" name="numbers" value="true">
				<input type="checkbox" id="symbols" name="symbols" value="true">
				<input type="number" id="length" name="length" min="0" value="16">
				<input type="number" id="counter" name="counter" min="1" value="1">
				<button type="button" onclick="javascript:createData()">Create</button>
			</div>
		LessPass JSON file output:<br>
		<textarea style="width: 381px; height: 345px;" id="lesspass-output"></textarea>
	</div>

<script type="text/javascript">
	function importData() {
		toggle_visibility("importDatas");
		var json = document.getElementById("lesspass-input").value;
		var link = document.getElementById("lesspass-emplacement").value;
		if (json){
			var obj = JSON.parse(json);
			document.getElementById("lesspass-links").innerHTML = parser(obj, link);
			document.getElementById("lesspass-output").innerHTML = JSON.stringify(obj);
		}
		toggle_visibility("exportDatas");
	}

	function parser(arr, link) {
		var data = '';

		for(i = 0; i < arr.length; ++i) {
			data += '<article><h2>' + arr[i].site + '</h2>';
			data += '<a href="' + link + 'index.html#/?site=' + arr[i].site + '&login=' + arr[i].login + '&uppercase=' + arr[i].uppercase + '&lowercase=' + arr[i].lowercase + '&numbers=' + arr[i].numbers + '&symbols=' + arr[i].symbols + '&length=' + arr[i].length + '&counter=' + arr[i].counter + '&version=2" target="_blank">LessPass Link</a>';
			data += '<ul>';
			data += '<li>login: ' + arr[i].login + '</li>';
			data += '</ul>';
			data += '</article>';
		}
		return data;
	}
	
	function createData() {
		var json = document.getElementById("lesspass-output").value;
		var obj = JSON.parse(json);

		var site = document.getElementById("site").value;
		var login = document.getElementById("login").value;
		var uppercase = document.getElementById("uppercase").value;
		var lowercase = document.getElementById("lowercase").value;
		var numbers = document.getElementById("numbers").value;
		var symbols = document.getElementById("symbols").value;
		var length = document.getElementById("length").value;
		var counter = document.getElementById("counter").value;
		
		var nObject = {site:site, login:login, uppercase:uppercase, lowercase:lowercase, numbers:numbers, symbols:symbols, length:length, counter:counter};
		obj.push(nObject);

		var link = document.getElementById("lesspass-emplacement").value;
		document.getElementById("lesspass-links").innerHTML = parser(obj, link);
		document.getElementById("lesspass-output").innerHTML = JSON.stringify(obj);		
	}

	
	function toggle_visibility(id) {
		var e = document.getElementById(id);
		if(e.style.display == 'block')
			e.style.display = 'none';
		else
			e.style.display = 'block';
   }
</script>

</body>
</html>
